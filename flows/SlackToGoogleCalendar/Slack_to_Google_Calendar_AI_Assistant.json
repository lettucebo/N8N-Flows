{
  "name": "Slack to Google Calendar AI Assistant",
  "nodes": [
    {
      "parameters": {
        "trigger": [
          "message"
        ],
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "C08NVUQUK8F"
        },
        "options": {}
      },
      "id": "8c0ad7b0-a88c-4be8-9010-d45e3203e9c0",
      "name": "Slack Trigger",
      "type": "n8n-nodes-base.slackTrigger",
      "typeVersion": 1,
      "position": [
        240,
        460
      ],
      "webhookId": "d8c9a4e7-f3d5-4c2a-9b8e-1234567890ab",
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "=={{$json.channel}}",
              "operation": "contains",
              "value2": "C08NVUQUK8F"
            },
            {
              "value1": "={{$json.type}}",
              "value2": "message"
            },
            {
              "value1": "={{$json.bot_id}}",
              "operation": "isEmpty"
            },
            {
              "value1": "={{$json.subtype}}",
              "operation": "isEmpty"
            },
            {
              "value1": "={{$json.thread_ts}}",
              "operation": "isEmpty"
            }
          ]
        }
      },
      "id": "filter-slack-messages",
      "name": "Filter Channel Messages",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        460,
        460
      ]
    },
    {
      "parameters": {
        "functionCode": "// ===============================================\n// Process AI Response - å®Œæ•´ç‰ˆ JavaScript ä»£ç¢¼\n// ===============================================\n\nconsole.log('ğŸš€ é–‹å§‹è™•ç† AI å›æ‡‰...');\n\n// 1. æª¢æŸ¥åŸºæœ¬è¼¸å…¥\nconst inputData = $input.first();\nif (!inputData || !inputData.json) {\n  console.log('âŒ æ²’æœ‰è¼¸å…¥æ•¸æ“šï¼Œåœæ­¢åŸ·è¡Œ');\n  return [];\n}\n\nconsole.log('ğŸ“¥ è¼¸å…¥æ•¸æ“š:', JSON.stringify(inputData.json, null, 2));\n\n// 2. å–å¾— AI è¼¸å‡ºï¼ˆå¾ text æ¬„ä½ï¼‰\nconst aiResponseText = inputData.json.text || inputData.json.output;\nif (!aiResponseText) {\n  console.log('âŒ AI æ²’æœ‰è¼¸å‡ºæ–‡å­—ï¼Œåœæ­¢åŸ·è¡Œ');\n  return [];\n}\n\nconsole.log('ğŸ¤– AI åŸå§‹å›æ‡‰:', aiResponseText);\n\n// 3. è§£æ JSON å­—ä¸²\nlet aiOutput;\ntry {\n  // æ¸…ç†å¯èƒ½çš„ markdown æ ¼å¼\n  const cleanResponse = aiResponseText.replace(/```json\\n?|```\\n?/g, '').trim();\n  aiOutput = JSON.parse(cleanResponse);\n  console.log('âœ… è§£æå¾Œçš„ AI è¼¸å‡º:', JSON.stringify(aiOutput, null, 2));\n} catch (error) {\n  console.log('âŒ JSON è§£æå¤±æ•—:', error.message);\n  return [{\n    json: {\n      status: 'error',\n      error: `AI å›æ‡‰è§£æå¤±æ•—: ${error.message}`,\n      rawResponse: aiResponseText,\n      slackUser: 'unknown',\n      slackChannel: 'unknown',\n      slackTimestamp: Date.now().toString()\n    }\n  }];\n}\n\n// 4. æª¢æŸ¥ Slack åŸå§‹æ•¸æ“š\nlet slackData = {};\ntry {\n  // å˜—è©¦å¤šç¨®æ–¹å¼å–å¾— Slack æ•¸æ“š\n  if ($node && $node[0] && $node[0].json) {\n    slackData = $node[0].json;\n  } else if ($('Webhook') && $('Webhook').first()) {\n    slackData = $('Webhook').first().json;\n  } else if ($('Slack Webhook') && $('Slack Webhook').first()) {\n    slackData = $('Slack Webhook').first().json;\n  } else {\n    // å¦‚æœç„¡æ³•å–å¾—åŸå§‹æ•¸æ“šï¼Œä½¿ç”¨é è¨­å€¼\n    slackData = {\n      text: 'ç„¡æ³•å–å¾—åŸå§‹è¨Šæ¯',\n      user: 'unknown',\n      channel: 'unknown',\n      ts: Date.now().toString()\n    };\n  }\n  console.log('ğŸ“± Slack æ•¸æ“š:', JSON.stringify(slackData, null, 2));\n} catch (error) {\n  console.log('âš ï¸ å–å¾— Slack æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤:', error.message);\n  slackData = {\n    text: 'ç„¡æ³•å–å¾—åŸå§‹è¨Šæ¯',\n    user: 'unknown', \n    channel: 'unknown',\n    ts: Date.now().toString()\n  };\n}\n\n// 5. æª¢æŸ¥ AI æ˜¯å¦æ‰¾åˆ°äº‹ä»¶\nif (!aiOutput.hasEvent || !aiOutput.events || aiOutput.events.length === 0) {\n  console.log('â„¹ï¸ AI æ²’æœ‰æ‰¾åˆ°äº‹ä»¶');\n  return [{\n    json: {\n      status: 'no_event',\n      message: 'æœªæ‰¾åˆ°æœ‰æ•ˆçš„æ—¥ç¨‹ä¿¡æ¯',\n      originalMessage: slackData.text,\n      slackUser: slackData.user,\n      slackChannel: slackData.channel,\n      slackTimestamp: slackData.ts,\n      reasoning: aiOutput.reasoning || 'ç„¡æ³•è­˜åˆ¥æ—¥ç¨‹ç›¸é—œå…§å®¹'\n    }\n  }];\n}\n\n// 6. è™•ç†æ‰¾åˆ°çš„äº‹ä»¶ï¼ˆæ”¯æ´å…¨å¤©æ´»å‹•ï¼‰\nconsole.log(`ğŸ“… æ‰¾åˆ° ${aiOutput.events.length} å€‹äº‹ä»¶ï¼Œé–‹å§‹è™•ç†`);\n\ntry {\n  const processedEvents = aiOutput.events.map((event, index) => {\n    console.log(`ğŸ”„ è™•ç†äº‹ä»¶ ${index}:`, JSON.stringify(event, null, 2));\n    \n    // é©—è­‰äº‹ä»¶æ˜¯å¦æœ‰å¿…è¦æ¬„ä½\n    if (!event.title && !event.startDateTime) {\n      console.log(`âš ï¸ äº‹ä»¶ ${index} ç¼ºå°‘å¿…è¦æ¬„ä½ï¼Œè·³é`);\n      return null;\n    }\n\n    // ğŸ¯ è™•ç†å…¨å¤©æ´»å‹•èˆ‡éƒ¨åˆ†æ™‚é–“æ´»å‹•\n    let startDateTime, endDateTime, isAllDay = false;\n    let calendarStartDateTime, calendarEndDateTime;\n    \n    try {\n      // æª¢æŸ¥æ˜¯å¦ç‚ºå…¨å¤©æ´»å‹•\n      const isAllDayEvent = event.isAllDay === true || \n                           (!event.startDateTime.includes('T') && !event.endDateTime.includes('T'));\n      \n      if (isAllDayEvent) {\n        // ğŸ“… å…¨å¤©æ´»å‹•è™•ç†\n        console.log(`ğŸ“… äº‹ä»¶ ${index} æ˜¯å…¨å¤©æ´»å‹•`);\n        isAllDay = true;\n        \n        // ç¢ºä¿æ—¥æœŸæ ¼å¼æ­£ç¢º (YYYY-MM-DD)\n        startDateTime = event.startDateTime.includes('T') \n          ? event.startDateTime.split('T')[0] \n          : event.startDateTime;\n        endDateTime = event.endDateTime.includes('T') \n          ? event.endDateTime.split('T')[0] \n          : event.endDateTime;\n          \n        // Google Calendar å…¨å¤©æ´»å‹•æ ¼å¼ï¼šç´”æ—¥æœŸå­—ä¸²\n        calendarStartDateTime = startDateTime;\n        calendarEndDateTime = endDateTime;\n        \n        // é©—è­‰æ—¥æœŸæ ¼å¼\n        if (!startDateTime.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n          throw new Error('å…¨å¤©æ´»å‹•æ—¥æœŸæ ¼å¼éŒ¯èª¤');\n        }\n        \n        console.log(`âœ… å…¨å¤©æ´»å‹•æ™‚é–“: ${startDateTime} åˆ° ${endDateTime}`);\n        \n      } else {\n        // â° éƒ¨åˆ†æ™‚é–“æ´»å‹•è™•ç†\n        console.log(`â° äº‹ä»¶ ${index} æ˜¯éƒ¨åˆ†æ™‚é–“æ´»å‹•`);\n        isAllDay = false;\n        \n        const startDate = new Date(event.startDateTime);\n        const endDate = new Date(event.endDateTime);\n        \n        if (isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {\n          throw new Error('ç„¡æ•ˆçš„æ—¥æœŸæ™‚é–“æ ¼å¼');\n        }\n        \n        // ç¢ºä¿çµæŸæ™‚é–“åœ¨é–‹å§‹æ™‚é–“ä¹‹å¾Œ\n        if (endDate <= startDate) {\n          endDate.setTime(startDate.getTime() + 60 * 60 * 1000);\n        }\n        \n        startDateTime = startDate.toISOString();\n        endDateTime = endDate.toISOString();\n        \n        // Google Calendar éƒ¨åˆ†æ™‚é–“æ´»å‹•æ ¼å¼ï¼šå®Œæ•´ ISO å­—ä¸²\n        calendarStartDateTime = startDateTime;\n        calendarEndDateTime = endDateTime;\n        \n        console.log(`âœ… éƒ¨åˆ†æ™‚é–“æ´»å‹•: ${startDateTime} åˆ° ${endDateTime}`);\n      }\n      \n    } catch (dateError) {\n      console.log(`âš ï¸ äº‹ä»¶ ${index} æ™‚é–“è™•ç†å¤±æ•—ï¼Œä½¿ç”¨é è¨­:`, dateError.message);\n      \n      // é è¨­ç‚ºæ˜å¤©çš„å…¨å¤©æ´»å‹•\n      const tomorrow = new Date();\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      const dateStr = tomorrow.toISOString().split('T')[0];\n      \n      startDateTime = dateStr;\n      endDateTime = dateStr;\n      calendarStartDateTime = dateStr;\n      calendarEndDateTime = dateStr;\n      isAllDay = true;\n    }\n    \n    // è™•ç†åƒèˆ‡è€…åˆ—è¡¨\n    const attendees = (event.attendees || []).filter(email => \n      email && email.includes('@') && email.includes('.')\n    );\n    \n    // ç¢ºä¿ confidence æ˜¯æµ®é»æ•¸\n    const confidence = parseFloat(event.confidence) || 0.5;\n    console.log(`ğŸ“Š äº‹ä»¶ ${index} ä¿¡å¿ƒåº¦: ${confidence} (${Math.round(confidence * 100)}%)`);\n    \n    // æ§‹å»ºè©³ç´°æè¿°\n    const description = [\n      event.description || '',\n      '',\n      'ğŸ“‹ ä¾†æºä¿¡æ¯ï¼š',\n      `â€¢ Slack è¨Šæ¯: ${slackData.text}`,\n      `â€¢ ç™¼é€è€…: <@${slackData.user}>`,\n      `â€¢ é »é“: <#${slackData.channel}>`,\n      `â€¢ æ´»å‹•é¡å‹: ${isAllDay ? 'ğŸ“… å…¨å¤©æ´»å‹•' : 'â° éƒ¨åˆ†æ™‚é–“æ´»å‹•'}`,\n      `â€¢ AI åˆ†æä¿¡å¿ƒåº¦: ${Math.round(confidence * 100)}%`,\n      aiOutput.reasoning ? `â€¢ åˆ†æèªªæ˜: ${aiOutput.reasoning}` : ''\n    ].filter(line => line !== '').join('\\n');\n    \n    // ğŸ¯ æ ¹æ“šä¿¡å¿ƒåº¦æ±ºå®šè™•ç†ç­–ç•¥\n    let eventStatus;\n    if (confidence >= 0.7) {\n      eventStatus = 'high_confidence';\n      console.log(`âœ… äº‹ä»¶ ${index} é«˜ä¿¡å¿ƒåº¦ï¼Œè‡ªå‹•è™•ç†`);\n    } else {\n      eventStatus = 'low_confidence';\n      console.log(`âš ï¸ äº‹ä»¶ ${index} ä½ä¿¡å¿ƒåº¦ï¼Œéœ€è¦ç¢ºèª`);\n    }\n    \n    const processedEvent = {\n      json: {\n        eventIndex: index,\n        title: event.title || 'æœªå‘½åäº‹ä»¶',\n        description: description,\n        \n        // ğŸ“… æ™‚é–“ä¿¡æ¯\n        startDateTime: calendarStartDateTime,\n        endDateTime: calendarEndDateTime,\n        isAllDay: isAllDay,\n        \n        // ğŸ“ åœ°é»å’Œåƒèˆ‡è€…\n        location: event.location || '',\n        attendees: attendees,\n        \n        // ğŸ“Š åˆ†æä¿¡æ¯\n        confidence: confidence,\n        reasoning: aiOutput.reasoning || '',\n        \n        // ğŸ“± åŸå§‹ä¿¡æ¯\n        originalMessage: slackData.text,\n        slackUser: slackData.user,\n        slackChannel: slackData.channel,\n        slackTimestamp: slackData.ts,\n        \n        // ğŸ”„ è™•ç†ç‹€æ…‹\n        status: eventStatus\n      }\n    };\n    \n    console.log(`âœ… äº‹ä»¶ ${index} è™•ç†å®Œæˆ:`, JSON.stringify(processedEvent.json, null, 2));\n    return processedEvent;\n  }).filter(event => event !== null);\n\n  // 7. æª¢æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„è™•ç†çµæœ\n  if (processedEvents.length === 0) {\n    console.log('âŒ æ²’æœ‰æœ‰æ•ˆçš„äº‹ä»¶å¯è™•ç†');\n    return [{\n      json: {\n        status: 'error',\n        error: 'æ‰€æœ‰äº‹ä»¶éƒ½è™•ç†å¤±æ•—',\n        originalMessage: slackData.text,\n        slackUser: slackData.user,\n        slackChannel: slackData.channel,\n        slackTimestamp: slackData.ts\n      }\n    }];\n  }\n\n  console.log(`ğŸ‰ æˆåŠŸè™•ç† ${processedEvents.length} å€‹äº‹ä»¶`);\n  console.log('ğŸ“¤ æœ€çµ‚è¼¸å‡º:', JSON.stringify(processedEvents, null, 2));\n  \n  return processedEvents;\n  \n} catch (error) {\n  console.log('âŒ è™•ç†äº‹ä»¶æ™‚ç™¼ç”ŸéŒ¯èª¤:', error.message);\n  console.log('ğŸ” éŒ¯èª¤å †ç–Š:', error.stack);\n  \n  return [{\n    json: {\n      status: 'error',\n      error: `è™•ç†å¤±æ•—: ${error.message}`,\n      originalMessage: slackData.text,\n      slackUser: slackData.user,\n      slackChannel: slackData.channel,\n      slackTimestamp: slackData.ts,\n      debugInfo: {\n        errorStack: error.stack,\n        inputData: inputData.json,\n        aiOutput: aiOutput\n      }\n    }\n  }];\n}\n\n// ===============================================\n// Confidence Filter æ›¿ä»£å‡½æ•¸ (å¯é¸)\n// ===============================================\n\n/*\n// å¦‚æœä½ æƒ³åœ¨ Process AI Response ä¸­ç›´æ¥è™•ç†ä¿¡å¿ƒåº¦éæ¿¾ï¼Œ\n// å¯ä»¥åœ¨ä¸Šé¢çš„ä»£ç¢¼ä¸­ä½¿ç”¨é€™å€‹é‚è¼¯æ›¿ä»£å–®ç¨çš„ Confidence Filter ç¯€é»ï¼š\n\nfunction filterByConfidence(events) {\n  const highConfidenceEvents = [];\n  const lowConfidenceEvents = [];\n  \n  events.forEach(event => {\n    if (event.json.confidence >= 0.7) {\n      event.json.status = 'high_confidence';\n      highConfidenceEvents.push(event);\n    } else {\n      event.json.status = 'low_confidence';\n      lowConfidenceEvents.push(event);\n    }\n  });\n  \n  return { highConfidenceEvents, lowConfidenceEvents };\n}\n*/\n\n// ===============================================\n// èª¿è©¦è¼”åŠ©å‡½æ•¸\n// ===============================================\n\n/*\n// å¦‚æœéœ€è¦èª¿è©¦ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨é€™å€‹å‡½æ•¸ï¼š\n\nfunction debugData(label, data) {\n  console.log(`ğŸ” ${label}:`);\n  console.log('- æ•¸æ“šé¡å‹:', typeof data);\n  console.log('- æ•¸æ“šå…§å®¹:', JSON.stringify(data, null, 2));\n  console.log('- æ˜¯å¦ç‚ºç©º:', !data);\n  console.log('- æ˜¯å¦ç‚ºå°è±¡:', typeof data === 'object');\n  console.log('---');\n}\n\n// ä½¿ç”¨ç¯„ä¾‹ï¼š\n// debugData('AI è¼¸å‡º', aiOutput);\n// debugData('Confidence å€¼', event.confidence);\n*/"
      },
      "id": "3cc251c9-728f-417b-a80a-207290d6290e",
      "name": "Process AI Response",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1056,
        460
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{parseFloat($json.confidence) >= 0.7}}",
              "value2": true
            }
          ]
        }
      },
      "id": "46555180-f9e7-44c4-b114-f941adc13adc",
      "name": "Confidence Filter",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1280,
        460
      ],
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "abc12207@gmail.com",
          "mode": "list",
          "cachedResultName": "abc12207@gmail.com"
        },
        "start": "={{$json.startDateTime}}",
        "end": "={{$json.endDateTime}}",
        "useDefaultReminders": false,
        "additionalFields": {
          "allday": "yes",
          "description": "={{$json.description}}",
          "location": "={{$json.location}}",
          "maxAttendees": 50,
          "sendUpdates": "none",
          "summary": "={{$json.title}}"
        },
        "remindersUi": {
          "remindersValues": [
            {
              "method": "popup",
              "minutes": 180
            }
          ]
        }
      },
      "id": "9b1a9087-efb1-4346-9680-09673497b489",
      "name": "Create Calendar Event",
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1,
      "position": [
        1716,
        260
      ],
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "ERUGcDCTMJESC4hA",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "channel": "=C08NVUQUK8F",
        "text": "=ğŸ‰ *è¡Œäº‹æ›†äº‹ä»¶å‰µå»ºæˆåŠŸï¼*\n\nğŸ“ *{{$json.summary}}*\n\nğŸ—“ï¸ *æ´»å‹•é¡å‹ï¼š* {{$json.start.date ? 'å…¨å¤©æ´»å‹•' : 'å®šæ™‚æ´»å‹•'}}\nğŸ“… *æ—¥æœŸï¼š* {{$json.start.date ? new Date($json.start.date + 'T12:00:00').toLocaleDateString('zh-TW', {year: 'numeric', month: '2-digit', day: '2-digit', weekday: 'long'}) : new Date($json.start.dateTime).toLocaleDateString('zh-TW', {timeZone: 'Asia/Taipei'})}}\nâ° *æ™‚é–“ï¼š* {{$json.start.date ? 'æ•´å¤©' : new Date($json.start.dateTime).toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit', timeZone: 'Asia/Taipei'}) + ' - ' + new Date($json.end.dateTime).toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit', timeZone: 'Asia/Taipei'})}}\nğŸ“ *åœ°é»ï¼š* {{$json.location || 'æœªæŒ‡å®š'}}\n\nğŸ“‹ *æ´»å‹•è©³æƒ…ï¼š*\n{{$json.description ? $json.description.substring(0, 300) + ($json.description.length > 300 ? '...' : '') : 'è«‹æŸ¥çœ‹å®Œæ•´è¡Œäº‹æ›†'}}\n\nğŸ”— [*æŸ¥çœ‹å®Œæ•´è¡Œäº‹æ›†äº‹ä»¶*](<{{$json.htmlLink}}>)\n\n_ğŸ¤– ç”± AI åŠ©æ‰‹è‡ªå‹•å‰µå»º â€¢ äº‹ä»¶ID: `{{$json.id}}`_\n_âœ¨ ç¥ä½ æ´»å‹•é †åˆ©æ„‰å¿«ï¼ âœ¨_",
        "otherOptions": {},
        "attachments": []
      },
      "id": "d8a44d97-e601-40ea-a28b-cb847da06bcf",
      "name": "Success Notification",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        1936,
        360
      ],
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "channel": "={{$json.slackChannel}}",
        "otherOptions": {},
        "attachments": []
      },
      "id": "a19c1160-28c0-4c90-acb2-c0cfff0e2fa9",
      "name": "Low Confidence Notification",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        1496,
        560
      ],
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "channel": "={{$('Slack Trigger1').first().json.event.channel}}",
        "otherOptions": {},
        "attachments": []
      },
      "id": "bfd47b15-51f6-48fd-862c-5deb0febc4a5",
      "name": "Error Notification",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        240,
        820
      ],
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=={{$json.text}}",
        "messages": {
          "messageValues": [
            {
              "message": "=ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„æ—¥ç¨‹ç®¡ç†åŠ©æ‰‹ã€‚è«‹åˆ†æç”¨æˆ¶çš„ Slack è¨Šæ¯ï¼Œæå–å¯èƒ½çš„æ—¥ç¨‹ä¿¡æ¯ã€‚\n\nğŸ¯ **é‡è¦åŸå‰‡ï¼šæ¯å€‹åˆ†æçµæœåªç”¢ç”Ÿä¸€å€‹ä¸»è¦äº‹ä»¶ï¼Œå°‡æ‰€æœ‰ç›¸é—œæ´»å‹•æ•´åˆç‚ºå®Œæ•´çš„æ´»å‹•æè¿°**\n\nğŸ” **åœ°é»åµæ¸¬è¦å‰‡**ï¼š\n1. ç§»å‹•å‹•è©å¾Œçš„åœ°é»ï¼šã€Œå»XXã€ã€ã€Œåˆ°XXã€ã€ã€Œå¾€XXã€ã€ã€Œèµ´XXã€ã€ã€Œå‰å¾€XXã€ã€ã€Œå‡ºç™¼åˆ°XXã€ã€ã€Œé£›å¾€XXã€\n2. ä½ç½®ä»‹è©å¾Œçš„åœ°é»ï¼šã€Œåœ¨XXã€ã€ã€Œæ–¼XXã€ã€ã€Œä½æ–¼XXã€ã€ã€ŒXXèˆ‰è¡Œã€ã€ã€ŒXXé€²è¡Œã€ã€ã€ŒXXå¬é–‹ã€\n3. å¸¸è¦‹åœ°é»é¡å‹ï¼šåŸå¸‚/åœ‹å®¶ã€åœ°æ¨™/æ™¯é»ã€å ´æ‰€ã€ç·šä¸Šå ´æ‰€ã€å»ºç¯‰ç‰©\n4. åœ°é»æå–å„ªå…ˆé †åºï¼šå…·é«”åœ°å€ > å»ºç¯‰åç¨± > åŸå¸‚åç¨± > å€åŸŸåç¨±\n5. å¤šåœ°é»æ´»å‹•ï¼šé¸æ“‡ä¸»è¦é›†åˆåœ°é»æˆ–æœ€é‡è¦çš„åœ°é»ä½œç‚ºä¸»è¦ location\n\nğŸ“… **æ´»å‹•é¡å‹è­˜åˆ¥ï¼ˆé‡è¦ï¼‰**ï¼š\n- **å…¨å¤©æ´»å‹•**ï¼š\n  - æ—…éŠã€ä¸€æ—¥éŠã€å‡ºå·®ã€ä¼‘å‡ã€ç¯€æ—¥æ…¶å…¸\n  - ç ”ç¿’ç‡Ÿã€å·¥ä½œåŠã€è¨“ç·´ç‡Ÿ\n  - å¤šåœ°é»è¡Œç¨‹æ´»å‹•ï¼ˆå³ä½¿æœ‰é›†åˆæ™‚é–“ä¹Ÿç®—å…¨å¤©æ´»å‹•ï¼‰\n  - åªæåˆ°æ—¥æœŸæ²’æœ‰å…·é«”æ™‚é–“\n- **å®šæ™‚æ´»å‹•**ï¼š\n  - å–®ä¸€åœ°é»çš„æœƒè­°ã€ç°¡å ±\n  - æœ‰æ˜ç¢ºé–‹å§‹å’ŒçµæŸæ™‚é–“çš„çŸ­æ™‚é–“æ´»å‹•\n  - éæ—…éŠæ€§è³ªçš„å®šæ™‚èšæœƒ\n\nâ° **æ™‚é–“æ ¼å¼è¦å‰‡**ï¼š\n- å…¨å¤©æ´»å‹•ï¼šstartDateTime å’Œ endDateTime éƒ½è¨­ç‚º \"YYYY-MM-DD\"ï¼ˆä¸åŒ…å«æ™‚é–“éƒ¨åˆ†ï¼‰ï¼ŒisAllDay: true\n- å®šæ™‚æ´»å‹•ï¼šä½¿ç”¨å®Œæ•´çš„ ISO 8601 æ ¼å¼ \"YYYY-MM-DDTHH:mm:ss+08:00\"ï¼ŒisAllDay: false\n- **å¹´ä»½æ¨æ–·è¦å‰‡**ï¼š\n  - å¦‚æœè¨Šæ¯ä¸­æ˜ç¢ºæŒ‡å®šå¹´ä»½ï¼Œä½¿ç”¨è©²å¹´ä»½\n  - å¦‚æœåªæœ‰æœˆ/æ—¥æ²’æœ‰å¹´ä»½ï¼Œæ¨æ–·é‚è¼¯ï¼š\n    - è‹¥æœˆä»½å¤§æ–¼ç•¶å‰æœˆä»½ï¼Œä½¿ç”¨ç•¶å‰å¹´ä»½\n    - è‹¥æœˆä»½å°æ–¼ç•¶å‰æœˆä»½ï¼Œä½¿ç”¨ä¸‹ä¸€å¹´ä»½\n    - è‹¥æœªæŒ‡å®šå¹´ä»½ä¸”ç„¡æ³•æ¨æ–·ï¼Œé è¨­ä½¿ç”¨ 2025 å¹´\n- æ™‚å€ï¼šAsia/Taipei (+08:00)\n\nâš ï¸ **é‡è¦æé†’**ï¼š\n- æ—…éŠã€ä¸€æ—¥éŠã€å¤šåœ°é»æ´»å‹•å³ä½¿æœ‰é›†åˆæ™‚é–“ï¼Œä¹Ÿæ‡‰è©²è¨­ç‚ºå…¨å¤©æ´»å‹•\n- å…¨å¤©æ´»å‹•çš„é–‹å§‹å’ŒçµæŸæ™‚é–“æ‡‰è©²ç›¸åŒï¼Œæ ¼å¼ç‚ºç´”æ—¥æœŸ\n\nğŸ“‹ **è©³ç´°æè¿°å…§å®¹å»ºæ§‹**ï¼š\nå¿…é ˆåŒ…å«ä»¥ä¸‹è³‡è¨Šï¼ˆå¦‚æœè¨Šæ¯ä¸­æœ‰æåŠï¼‰ï¼š\n1. **é›†åˆè³‡è¨Š**ï¼šé›†åˆæ™‚é–“ã€é›†åˆåœ°é»ã€åœè»Šè³‡è¨Š\n2. **å®Œæ•´è¡Œç¨‹**ï¼šæŒ‰æ™‚é–“é †åºåˆ—å‡ºæ‰€æœ‰æ´»å‹•å®‰æ’\n3. **è²»ç”¨æ˜ç´°**ï¼šå„é …è²»ç”¨ï¼ˆäº¤é€šã€é¤è²»ã€é–€ç¥¨ç­‰ï¼‰\n4. **åƒèˆ‡è€…è³‡è¨Š**ï¼šè»Šæ‰‹å®‰æ’ã€åƒåŠ äººå“¡\n5. **æ”œå¸¶ç‰©å“**ï¼šéœ€è¦æº–å‚™çš„ç‰©å“æˆ–è¡£ç‰©\n6. **æ³¨æ„äº‹é …**ï¼šå¤©æ°£ã€å–æ¶ˆæ¢ä»¶ã€å…¶ä»–é‡è¦æé†’\n7. **è¯çµ¡è³‡è¨Š**ï¼šç›¸é—œé€£çµã€åƒè€ƒè³‡æ–™ï¼ˆä¿æŒå®Œæ•´ç¶²å€ï¼‰\n\nğŸ‘¥ **åƒèˆ‡è€…æå–è¦å‰‡**ï¼š\n- **é‡è¦ï¼šattendees æ¬„ä½è«‹ä¿æŒç©ºé™£åˆ— []ï¼Œé¿å…ç™¼é€ Google Calendar é€šçŸ¥**\n- æ‰€æœ‰åƒèˆ‡è€…è³‡è¨Šï¼ˆåŒ…å«è»Šæ‰‹å’Œä¹˜å®¢ï¼‰éƒ½å¯«åœ¨ description ä¸­\n- é€™æ¨£å¯ä»¥é¿å… Google Calendar è‡ªå‹•ç™¼é€é‚€è«‹é€šçŸ¥\n\nğŸ’° **è²»ç”¨è³‡è¨Šæå–**ï¼š\n- äº¤é€šè²»ã€é¤è²»ã€é–€ç¥¨ã€å…¶ä»–é›œè²»\n- åœ¨ description ä¸­è©³ç´°èªªæ˜å„é …è²»ç”¨\n\nğŸ”— **é€£çµè™•ç†**ï¼š\n- ä¿æŒç¶²å€å®Œæ•´ï¼Œä¸è¦æˆªæ–·\n- å¦‚æœé€£çµå¤ªé•·ï¼Œç¢ºä¿åŒ…å«å®Œæ•´çš„å¯é»æ“Šç¶²å€\n\nğŸ¯ **ä¿¡å¿ƒåº¦è©•ä¼°**ï¼š\n- 0.9+ï¼šå®Œæ•´æ™‚é–“+åœ°é»+è©³ç´°è¡Œç¨‹+åƒèˆ‡è€…è³‡è¨Š\n- 0.7-0.9ï¼šæ˜ç¢ºæ™‚é–“å’Œåœ°é»ï¼Œéƒ¨åˆ†è©³ç´°è³‡è¨Š\n- 0.5-0.7ï¼šåŸºæœ¬æ™‚é–“æˆ–åœ°é»ï¼Œç¼ºå°‘è©³ç´°è³‡è¨Š\n- <0.5ï¼šç¼ºä¹é—œéµä¿¡æ¯\n\nè«‹æŒ‰ç…§ä»¥ä¸‹ JSON æ ¼å¼å›è¦†ï¼Œä¸è¦æ·»åŠ ä»»ä½•å…¶ä»–æ–‡å­—ï¼š\n{\n  \"hasEvent\": true,\n  \"events\": [\n    {\n      \"title\": \"ä¸»è¦æ´»å‹•æ¨™é¡Œ\",\n      \"description\": \"è©³ç´°çš„æ´»å‹•æè¿°ï¼ŒåŒ…å«å®Œæ•´è¡Œç¨‹å®‰æ’ã€é›†åˆè³‡è¨Šã€è²»ç”¨æ˜ç´°ã€åƒèˆ‡è€…è³‡è¨Šã€æ³¨æ„äº‹é …ç­‰\",\n      \"startDateTime\": \"2025-06-29\",\n      \"endDateTime\": \"2025-06-29\", \n      \"isAllDay\": true,\n      \"location\": \"ä¸»è¦é›†åˆåœ°é»æˆ–æœ€é‡è¦çš„åœ°é»\",\n      \"attendees\": [],\n      \"confidence\": 0.95\n    }\n  ],\n  \"reasoning\": \"åˆ†æåŸå› ï¼Œèªªæ˜å¦‚ä½•æ•´åˆå¤šå€‹æ´»å‹•ç‚ºå–®ä¸€äº‹ä»¶ï¼Œä»¥åŠä¿¡å¿ƒåº¦è©•ä¼°ä¾æ“š\"\n}\n\n**æ´»å‹•é¡å‹åˆ¤æ–·ç¯„ä¾‹**ï¼š\n- âœ… å…¨å¤©æ´»å‹•ï¼šã€Œä¸‰å³½ç€‘å¸ƒä¸€æ—¥éŠã€â†’ isAllDay: true, startDateTime: \"2025-06-29\"\n- âœ… å…¨å¤©æ´»å‹•ï¼šã€Œå·¥ä½œåŠã€â†’ isAllDay: true, startDateTime: \"2025-06-15\"  \n- âœ… å®šæ™‚æ´»å‹•ï¼šã€Œä¸‹åˆ2é»é–‹æœƒã€â†’ isAllDay: false, startDateTime: \"2025-06-01T14:00:00+08:00\"\n- âœ… å®šæ™‚æ´»å‹•ï¼šã€Œç°¡å ±1å°æ™‚ã€â†’ isAllDay: false, startDateTime: \"2025-06-01T14:00:00+08:00\"\n\n**æè¿°æ ¼å¼å»ºè­°**ï¼š\nä½¿ç”¨æ¸…æ™°çš„çµæ§‹åŒ–æ ¼å¼ï¼Œå°‡æ‰€æœ‰åƒèˆ‡è€…è³‡è¨Šå¯«åœ¨æè¿°ä¸­ï¼š\n```\né›†åˆæ™‚é–“ï¼š9:30 a.m.ï¼›é›†åˆåœ°é»ï¼šä¸‰å³½å€ç«¹å´™è·¯238è™Ÿï¼ˆç¦¾ç…¦ç†Šç©ºèŒ¶åœ’å¤–ç¢°é¢+åœè»Šï¼‰ã€‚\n\nè¡Œç¨‹å®‰æ’ï¼š\nâ€¢ ä¸Šåˆï¼šåƒè¨ªç¦¾ç…¦ç†Šç©ºèŒ¶åœ’\nâ€¢ ä¸­åˆï¼šä¸‰å³½æ’è§’133ç¾çƒ¤èƒ¡æ¤’é›ç”¨é¤  \nâ€¢ ä¸‹åˆï¼šé›²æ£®ç€‘å¸ƒå¥è¡Œ+ç©æ°´æ³¡è…³\nâ€¢ å‚æ™šï¼šä¸‰å³½è€è¡—è‡ªç”±æ´»å‹•\n\nè²»ç”¨ï¼šè»Šè³‡200å…ƒï¼›é¤è²»200-400å…ƒï¼›èŒ¶åœ’é–€ç¥¨280å…ƒï¼ˆå¯æŠµé¤é»100å…ƒï¼‰ã€‚\n\nè»Šæ‰‹å®‰æ’ï¼š\nâ€¢ @å°æ³‰ï¼šVivian, Conni, Lucia\nâ€¢ @bryanï¼šTing, Vera, å“²ç‘‹\nâ€¢ @éŸ‹æˆï¼šå°å¼µ, è¬å°ç¥, ç‹ç¾æƒ \nâ€¢ @Money Yuï¼šå…¶ä»–åƒèˆ‡è€…\n\næ³¨æ„äº‹é …ï¼šé‡é›¨å–æ¶ˆ/æ”¹æœŸï¼Œè«‹æ”œå¸¶æ›æ´—è¡£ç‰©ã€‚\n```\n\nç¾åœ¨è«‹åˆ†æä»¥ä¸‹ Slack è¨Šæ¯ï¼šã€Œ={{$json.text}}ã€\n\nè«‹å°‡æ•´å€‹æ´»å‹•è¦–ç‚ºä¸€å€‹å®Œæ•´äº‹ä»¶ï¼ŒæŠŠæ‰€æœ‰ç´°ç¯€ã€è¡Œç¨‹å®‰æ’ã€åƒèˆ‡è€…è³‡è¨Šéƒ½æ•´ç†åœ¨ description ä¸­ï¼Œç›´æ¥å›è¦† JSON æ ¼å¼ï¼Œä¸è¦åŒ…å« ```json æ¨™è¨˜ã€‚"
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.6,
      "position": [
        680,
        460
      ],
      "id": "8647c7c5-4e06-482e-8fd8-df39c3077d31",
      "name": "Basic LLM Chain"
    },
    {
      "parameters": {
        "model": "o4-mini",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "typeVersion": 1,
      "position": [
        768,
        680
      ],
      "id": "2dafdd15-fc8c-468f-ab93-caf25ce29c9f",
      "name": "Azure OpenAI Chat Model",
      "credentials": {
        "azureOpenAiApi": {
          "id": "CtgkMRzzV4whz91f",
          "name": "Azure Open AI account"
        }
      }
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "abc12207@gmail.com",
          "mode": "list",
          "cachedResultName": "abc12207@gmail.com"
        },
        "start": "={{$json.startDateTime}}",
        "end": "={{$json.endDateTime}}",
        "useDefaultReminders": false,
        "additionalFields": {
          "allday": "no",
          "description": "={{$json.description}}",
          "location": "={{$json.location}}",
          "maxAttendees": 50,
          "sendUpdates": "none",
          "summary": "={{$json.title}}"
        },
        "remindersUi": {
          "remindersValues": [
            {
              "method": "popup",
              "minutes": 180
            },
            {
              "method": "popup",
              "minutes": 90
            },
            {
              "method": "popup",
              "minutes": 10
            },
            {
              "method": "popup",
              "minutes": 1
            }
          ]
        }
      },
      "id": "0f6d6c00-f47a-400f-b443-3b7c0ac88fc8",
      "name": "Create Calendar Event3",
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1,
      "position": [
        1716,
        460
      ],
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "ERUGcDCTMJESC4hA",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "fbf960d0-2def-463d-9c6b-e9fa9d63368a",
              "leftValue": "={{ $json.isAllDay }}",
              "rightValue": "true",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1496,
        360
      ],
      "id": "1c707ca2-6571-4347-a56b-3e79f85d99bc",
      "name": "All Day Event branch"
    }
  ],
  "pinData": {},
  "connections": {
    "Slack Trigger": {
      "main": [
        [
          {
            "node": "Filter Channel Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Channel Messages": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process AI Response": {
      "main": [
        [
          {
            "node": "Confidence Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Confidence Filter": {
      "main": [
        [
          {
            "node": "All Day Event branch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Low Confidence Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Calendar Event": {
      "main": [
        [
          {
            "node": "Success Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Azure OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "Process AI Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Calendar Event3": {
      "main": [
        [
          {
            "node": "Success Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "All Day Event branch": {
      "main": [
        [
          {
            "node": "Create Calendar Event",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create Calendar Event3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "saveExecutionProgress": true,
    "saveManualExecutions": true,
    "saveDataErrorExecution": "all",
    "saveDataSuccessExecution": "all",
    "executionTimeout": 3600,
    "timezone": "UTC"
  },
  "versionId": "79cea021-4b56-49e4-a812-e92af9302a58",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4f325a7cd315a1a79ed49dc0c3f91bbcfea6ece3018280e4ffc9f22ce531b657"
  },
  "id": "I2dch7ZKvBvX6GVC",
  "tags": []
}