{
  "name": "Slack to Google Calendar AI Assistant",
  "nodes": [
    {
      "parameters": {
        "trigger": [
          "message"
        ],
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "C08NVUQUK8F"
        },
        "options": {}
      },
      "id": "8c0ad7b0-a88c-4be8-9010-d45e3203e9c0",
      "name": "Slack Trigger",
      "type": "n8n-nodes-base.slackTrigger",
      "typeVersion": 1,
      "position": [
        240,
        460
      ],
      "webhookId": "d8c9a4e7-f3d5-4c2a-9b8e-1234567890ab",
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "=={{$json.channel}}",
              "operation": "contains",
              "value2": "C08NVUQUK8F"
            },
            {
              "value1": "={{$json.type}}",
              "value2": "message"
            },
            {
              "value1": "={{$json.bot_id}}",
              "operation": "isEmpty"
            },
            {
              "value1": "={{$json.subtype}}",
              "operation": "isEmpty"
            },
            {
              "value1": "={{$json.thread_ts}}",
              "operation": "isEmpty"
            }
          ]
        }
      },
      "id": "filter-slack-messages",
      "name": "Filter Channel Messages",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        460,
        460
      ]
    },
    {
      "parameters": {
        "functionCode": "// ===============================================\n// Process AI Response - å®Œæ•´ç‰ˆ JavaScript ä»£ç¢¼\n// ===============================================\n\nconsole.log('ğŸš€ é–‹å§‹è™•ç† AI å›æ‡‰...');\n\n// 1. æª¢æŸ¥åŸºæœ¬è¼¸å…¥\nconst inputData = $input.first();\nif (!inputData || !inputData.json) {\n  console.log('âŒ æ²’æœ‰è¼¸å…¥æ•¸æ“šï¼Œåœæ­¢åŸ·è¡Œ');\n  return [];\n}\n\nconsole.log('ğŸ“¥ è¼¸å…¥æ•¸æ“š:', JSON.stringify(inputData.json, null, 2));\n\n// 2. å–å¾— AI è¼¸å‡ºï¼ˆå¾ text æ¬„ä½ï¼‰\nconst aiResponseText = inputData.json.text || inputData.json.output;\nif (!aiResponseText) {\n  console.log('âŒ AI æ²’æœ‰è¼¸å‡ºæ–‡å­—ï¼Œåœæ­¢åŸ·è¡Œ');\n  return [];\n}\n\nconsole.log('ğŸ¤– AI åŸå§‹å›æ‡‰:', aiResponseText);\n\n// 3. è§£æ JSON å­—ä¸²\nlet aiOutput;\ntry {\n  // æ¸…ç†å¯èƒ½çš„ markdown æ ¼å¼\n  const cleanResponse = aiResponseText.replace(/```json\\n?|```\\n?/g, '').trim();\n  aiOutput = JSON.parse(cleanResponse);\n  console.log('âœ… è§£æå¾Œçš„ AI è¼¸å‡º:', JSON.stringify(aiOutput, null, 2));\n} catch (error) {\n  console.log('âŒ JSON è§£æå¤±æ•—:', error.message);\n  return [{\n    json: {\n      status: 'error',\n      error: `AI å›æ‡‰è§£æå¤±æ•—: ${error.message}`,\n      rawResponse: aiResponseText,\n      slackUser: 'unknown',\n      slackChannel: 'unknown',\n      slackTimestamp: Date.now().toString()\n    }\n  }];\n}\n\n// 4. æª¢æŸ¥ Slack åŸå§‹æ•¸æ“š\nlet slackData = {};\ntry {\n  // å˜—è©¦å¤šç¨®æ–¹å¼å–å¾— Slack æ•¸æ“š\n  if ($node && $node[0] && $node[0].json) {\n    slackData = $node[0].json;\n  } else if ($('Webhook') && $('Webhook').first()) {\n    slackData = $('Webhook').first().json;\n  } else if ($('Slack Webhook') && $('Slack Webhook').first()) {\n    slackData = $('Slack Webhook').first().json;\n  } else {\n    // å¦‚æœç„¡æ³•å–å¾—åŸå§‹æ•¸æ“šï¼Œä½¿ç”¨é è¨­å€¼\n    slackData = {\n      text: 'ç„¡æ³•å–å¾—åŸå§‹è¨Šæ¯',\n      user: 'unknown',\n      channel: 'unknown',\n      ts: Date.now().toString()\n    };\n  }\n  console.log('ğŸ“± Slack æ•¸æ“š:', JSON.stringify(slackData, null, 2));\n} catch (error) {\n  console.log('âš ï¸ å–å¾— Slack æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤:', error.message);\n  slackData = {\n    text: 'ç„¡æ³•å–å¾—åŸå§‹è¨Šæ¯',\n    user: 'unknown', \n    channel: 'unknown',\n    ts: Date.now().toString()\n  };\n}\n\n// 5. æª¢æŸ¥ AI æ˜¯å¦æ‰¾åˆ°äº‹ä»¶\nif (!aiOutput.hasEvent || !aiOutput.events || aiOutput.events.length === 0) {\n  console.log('â„¹ï¸ AI æ²’æœ‰æ‰¾åˆ°äº‹ä»¶');\n  return [{\n    json: {\n      status: 'no_event',\n      message: 'æœªæ‰¾åˆ°æœ‰æ•ˆçš„æ—¥ç¨‹ä¿¡æ¯',\n      originalMessage: slackData.text,\n      slackUser: slackData.user,\n      slackChannel: slackData.channel,\n      slackTimestamp: slackData.ts,\n      reasoning: aiOutput.reasoning || 'ç„¡æ³•è­˜åˆ¥æ—¥ç¨‹ç›¸é—œå…§å®¹'\n    }\n  }];\n}\n\n// 6. è™•ç†æ‰¾åˆ°çš„äº‹ä»¶ï¼ˆæ”¯æ´å…¨å¤©æ´»å‹•ï¼‰\nconsole.log(`ğŸ“… æ‰¾åˆ° ${aiOutput.events.length} å€‹äº‹ä»¶ï¼Œé–‹å§‹è™•ç†`);\n\ntry {\n  const processedEvents = aiOutput.events.map((event, index) => {\n    console.log(`ğŸ”„ è™•ç†äº‹ä»¶ ${index}:`, JSON.stringify(event, null, 2));\n    \n    // é©—è­‰äº‹ä»¶æ˜¯å¦æœ‰å¿…è¦æ¬„ä½\n    if (!event.title && !event.startDateTime) {\n      console.log(`âš ï¸ äº‹ä»¶ ${index} ç¼ºå°‘å¿…è¦æ¬„ä½ï¼Œè·³é`);\n      return null;\n    }\n\n    // ğŸ¯ è™•ç†å…¨å¤©æ´»å‹•èˆ‡éƒ¨åˆ†æ™‚é–“æ´»å‹•\n    let startDateTime, endDateTime, isAllDay = false;\n    let calendarStartDateTime, calendarEndDateTime;\n    \n    try {\n      // æª¢æŸ¥æ˜¯å¦ç‚ºå…¨å¤©æ´»å‹•\n      const isAllDayEvent = event.isAllDay === true || \n                           (!event.startDateTime.includes('T') && !event.endDateTime.includes('T'));\n      \n      if (isAllDayEvent) {\n        // ğŸ“… å…¨å¤©æ´»å‹•è™•ç†\n        console.log(`ğŸ“… äº‹ä»¶ ${index} æ˜¯å…¨å¤©æ´»å‹•`);\n        isAllDay = true;\n        \n        // ç¢ºä¿æ—¥æœŸæ ¼å¼æ­£ç¢º (YYYY-MM-DD)\n        startDateTime = event.startDateTime.includes('T') \n          ? event.startDateTime.split('T')[0] \n          : event.startDateTime;\n        endDateTime = event.endDateTime.includes('T') \n          ? event.endDateTime.split('T')[0] \n          : event.endDateTime;\n          \n        // Google Calendar å…¨å¤©æ´»å‹•æ ¼å¼ï¼šç´”æ—¥æœŸå­—ä¸²\n        calendarStartDateTime = startDateTime;\n        calendarEndDateTime = endDateTime;\n        \n        // é©—è­‰æ—¥æœŸæ ¼å¼\n        if (!startDateTime.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n          throw new Error('å…¨å¤©æ´»å‹•æ—¥æœŸæ ¼å¼éŒ¯èª¤');\n        }\n        \n        console.log(`âœ… å…¨å¤©æ´»å‹•æ™‚é–“: ${startDateTime} åˆ° ${endDateTime}`);\n        \n      } else {\n        // â° éƒ¨åˆ†æ™‚é–“æ´»å‹•è™•ç†\n        console.log(`â° äº‹ä»¶ ${index} æ˜¯éƒ¨åˆ†æ™‚é–“æ´»å‹•`);\n        isAllDay = false;\n        \n        const startDate = new Date(event.startDateTime);\n        const endDate = new Date(event.endDateTime);\n        \n        if (isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {\n          throw new Error('ç„¡æ•ˆçš„æ—¥æœŸæ™‚é–“æ ¼å¼');\n        }\n        \n        // ç¢ºä¿çµæŸæ™‚é–“åœ¨é–‹å§‹æ™‚é–“ä¹‹å¾Œ\n        if (endDate <= startDate) {\n          endDate.setTime(startDate.getTime() + 60 * 60 * 1000);\n        }\n        \n        startDateTime = startDate.toISOString();\n        endDateTime = endDate.toISOString();\n        \n        // Google Calendar éƒ¨åˆ†æ™‚é–“æ´»å‹•æ ¼å¼ï¼šå®Œæ•´ ISO å­—ä¸²\n        calendarStartDateTime = startDateTime;\n        calendarEndDateTime = endDateTime;\n        \n        console.log(`âœ… éƒ¨åˆ†æ™‚é–“æ´»å‹•: ${startDateTime} åˆ° ${endDateTime}`);\n      }\n      \n    } catch (dateError) {\n      console.log(`âš ï¸ äº‹ä»¶ ${index} æ™‚é–“è™•ç†å¤±æ•—ï¼Œä½¿ç”¨é è¨­:`, dateError.message);\n      \n      // é è¨­ç‚ºæ˜å¤©çš„å…¨å¤©æ´»å‹•\n      const tomorrow = new Date();\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      const dateStr = tomorrow.toISOString().split('T')[0];\n      \n      startDateTime = dateStr;\n      endDateTime = dateStr;\n      calendarStartDateTime = dateStr;\n      calendarEndDateTime = dateStr;\n      isAllDay = true;\n    }\n    \n    // è™•ç†åƒèˆ‡è€…åˆ—è¡¨\n    const attendees = (event.attendees || []).filter(email => \n      email && email.includes('@') && email.includes('.')\n    );\n    \n    // ç¢ºä¿ confidence æ˜¯æµ®é»æ•¸\n    const confidence = parseFloat(event.confidence) || 0.5;\n    console.log(`ğŸ“Š äº‹ä»¶ ${index} ä¿¡å¿ƒåº¦: ${confidence} (${Math.round(confidence * 100)}%)`);\n    \n    // æ§‹å»ºè©³ç´°æè¿°\n    const description = [\n      event.description || '',\n      '',\n      'ğŸ“‹ ä¾†æºä¿¡æ¯ï¼š',\n      `â€¢ Slack è¨Šæ¯: ${slackData.text}`,\n      `â€¢ ç™¼é€è€…: <@${slackData.user}>`,\n      `â€¢ é »é“: <#${slackData.channel}>`,\n      `â€¢ æ´»å‹•é¡å‹: ${isAllDay ? 'ğŸ“… å…¨å¤©æ´»å‹•' : 'â° éƒ¨åˆ†æ™‚é–“æ´»å‹•'}`,\n      `â€¢ AI åˆ†æä¿¡å¿ƒåº¦: ${Math.round(confidence * 100)}%`,\n      aiOutput.reasoning ? `â€¢ åˆ†æèªªæ˜: ${aiOutput.reasoning}` : ''\n    ].filter(line => line !== '').join('\\n');\n    \n    // ğŸ¯ æ ¹æ“šä¿¡å¿ƒåº¦æ±ºå®šè™•ç†ç­–ç•¥\n    let eventStatus;\n    if (confidence >= 0.7) {\n      eventStatus = 'high_confidence';\n      console.log(`âœ… äº‹ä»¶ ${index} é«˜ä¿¡å¿ƒåº¦ï¼Œè‡ªå‹•è™•ç†`);\n    } else {\n      eventStatus = 'low_confidence';\n      console.log(`âš ï¸ äº‹ä»¶ ${index} ä½ä¿¡å¿ƒåº¦ï¼Œéœ€è¦ç¢ºèª`);\n    }\n    \n    const processedEvent = {\n      json: {\n        eventIndex: index,\n        title: event.title || 'æœªå‘½åäº‹ä»¶',\n        description: description,\n        \n        // ğŸ“… æ™‚é–“ä¿¡æ¯\n        startDateTime: calendarStartDateTime,\n        endDateTime: calendarEndDateTime,\n        isAllDay: isAllDay,\n        \n        // ğŸ“ åœ°é»å’Œåƒèˆ‡è€…\n        location: event.location || '',\n        attendees: attendees,\n        \n        // ğŸ“Š åˆ†æä¿¡æ¯\n        confidence: confidence,\n        reasoning: aiOutput.reasoning || '',\n        \n        // ğŸ“± åŸå§‹ä¿¡æ¯\n        originalMessage: slackData.text,\n        slackUser: slackData.user,\n        slackChannel: slackData.channel,\n        slackTimestamp: slackData.ts,\n        \n        // ğŸ”„ è™•ç†ç‹€æ…‹\n        status: eventStatus\n      }\n    };\n    \n    console.log(`âœ… äº‹ä»¶ ${index} è™•ç†å®Œæˆ:`, JSON.stringify(processedEvent.json, null, 2));\n    return processedEvent;\n  }).filter(event => event !== null);\n\n  // 7. æª¢æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„è™•ç†çµæœ\n  if (processedEvents.length === 0) {\n    console.log('âŒ æ²’æœ‰æœ‰æ•ˆçš„äº‹ä»¶å¯è™•ç†');\n    return [{\n      json: {\n        status: 'error',\n        error: 'æ‰€æœ‰äº‹ä»¶éƒ½è™•ç†å¤±æ•—',\n        originalMessage: slackData.text,\n        slackUser: slackData.user,\n        slackChannel: slackData.channel,\n        slackTimestamp: slackData.ts\n      }\n    }];\n  }\n\n  console.log(`ğŸ‰ æˆåŠŸè™•ç† ${processedEvents.length} å€‹äº‹ä»¶`);\n  console.log('ğŸ“¤ æœ€çµ‚è¼¸å‡º:', JSON.stringify(processedEvents, null, 2));\n  \n  return processedEvents;\n  \n} catch (error) {\n  console.log('âŒ è™•ç†äº‹ä»¶æ™‚ç™¼ç”ŸéŒ¯èª¤:', error.message);\n  console.log('ğŸ” éŒ¯èª¤å †ç–Š:', error.stack);\n  \n  return [{\n    json: {\n      status: 'error',\n      error: `è™•ç†å¤±æ•—: ${error.message}`,\n      originalMessage: slackData.text,\n      slackUser: slackData.user,\n      slackChannel: slackData.channel,\n      slackTimestamp: slackData.ts,\n      debugInfo: {\n        errorStack: error.stack,\n        inputData: inputData.json,\n        aiOutput: aiOutput\n      }\n    }\n  }];\n}\n\n// ===============================================\n// Confidence Filter æ›¿ä»£å‡½æ•¸ (å¯é¸)\n// ===============================================\n\n/*\n// å¦‚æœä½ æƒ³åœ¨ Process AI Response ä¸­ç›´æ¥è™•ç†ä¿¡å¿ƒåº¦éæ¿¾ï¼Œ\n// å¯ä»¥åœ¨ä¸Šé¢çš„ä»£ç¢¼ä¸­ä½¿ç”¨é€™å€‹é‚è¼¯æ›¿ä»£å–®ç¨çš„ Confidence Filter ç¯€é»ï¼š\n\nfunction filterByConfidence(events) {\n  const highConfidenceEvents = [];\n  const lowConfidenceEvents = [];\n  \n  events.forEach(event => {\n    if (event.json.confidence >= 0.7) {\n      event.json.status = 'high_confidence';\n      highConfidenceEvents.push(event);\n    } else {\n      event.json.status = 'low_confidence';\n      lowConfidenceEvents.push(event);\n    }\n  });\n  \n  return { highConfidenceEvents, lowConfidenceEvents };\n}\n*/\n\n// ===============================================\n// èª¿è©¦è¼”åŠ©å‡½æ•¸\n// ===============================================\n\n/*\n// å¦‚æœéœ€è¦èª¿è©¦ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨é€™å€‹å‡½æ•¸ï¼š\n\nfunction debugData(label, data) {\n  console.log(`ğŸ” ${label}:`);\n  console.log('- æ•¸æ“šé¡å‹:', typeof data);\n  console.log('- æ•¸æ“šå…§å®¹:', JSON.stringify(data, null, 2));\n  console.log('- æ˜¯å¦ç‚ºç©º:', !data);\n  console.log('- æ˜¯å¦ç‚ºå°è±¡:', typeof data === 'object');\n  console.log('---');\n}\n\n// ä½¿ç”¨ç¯„ä¾‹ï¼š\n// debugData('AI è¼¸å‡º', aiOutput);\n// debugData('Confidence å€¼', event.confidence);\n*/"
      },
      "id": "3cc251c9-728f-417b-a80a-207290d6290e",
      "name": "Process AI Response",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1056,
        460
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{parseFloat($json.confidence) >= 0.7}}",
              "value2": true
            }
          ]
        }
      },
      "id": "46555180-f9e7-44c4-b114-f941adc13adc",
      "name": "Confidence Filter",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1276,
        460
      ],
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "abc12207@gmail.com",
          "mode": "list",
          "cachedResultName": "abc12207@gmail.com"
        },
        "start": "={{$json.startDateTime}}",
        "end": "={{$json.endDateTime}}",
        "additionalFields": {
          "allday": "yes",
          "description": "={{$json.description}}",
          "location": "={{$json.location}}",
          "maxAttendees": 50,
          "sendUpdates": "all",
          "summary": "={{$json.title}}"
        }
      },
      "id": "9b1a9087-efb1-4346-9680-09673497b489",
      "name": "Create Calendar Event",
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1,
      "position": [
        1716,
        260
      ],
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "ERUGcDCTMJESC4hA",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "channel": "=C08NVUQUK8F",
        "text": "=âœ… **æ—¥æ›†äº‹ä»¶å·²æˆåŠŸå‰µå»ºï¼**  ğŸ“… **{{$json.summary}}** {{$json.start.date ?    'ğŸ—“ï¸ æ—¥æœŸ: ' + DateTime.fromFormat($json.start.date, 'yyyy-MM-dd').toFormat('MMæœˆddæ—¥ (cccc)', {locale: 'zh-TW'}) :    'ğŸ• æ™‚é–“: ' + DateTime.fromISO($json.start.dateTime).toFormat('MMæœˆddæ—¥ (cccc) HH:mm', {locale: 'zh-TW'}) + ' - ' + DateTime.fromISO($json.end.dateTime).toFormat('HH:mm', {locale: 'zh-TW'}) }} ğŸ“ åœ°é»: {{$json.location || 'æœªæŒ‡å®š'}} {{$json.description ? 'ğŸ“ å‚™è¨»: ' + $json.description.split('ğŸ“‹ ä¾†æºä¿¡æ¯ï¼š')[0].trim() : ''}}  ğŸ”— [æŸ¥çœ‹äº‹ä»¶]({{$json.htmlLink}})  _ğŸ¤– ç”± AI åŠ©æ‰‹è‡ªå‹•å‰µå»º â€¢ äº‹ä»¶ID: {{$json.id}}_",
        "otherOptions": {},
        "attachments": []
      },
      "id": "d8a44d97-e601-40ea-a28b-cb847da06bcf",
      "name": "Success Notification",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        1936,
        360
      ],
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "channel": "={{$json.slackChannel}}",
        "otherOptions": {},
        "attachments": []
      },
      "id": "a19c1160-28c0-4c90-acb2-c0cfff0e2fa9",
      "name": "Low Confidence Notification",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        1496,
        560
      ],
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "channel": "={{$('Slack Trigger1').first().json.event.channel}}",
        "otherOptions": {},
        "attachments": []
      },
      "id": "bfd47b15-51f6-48fd-862c-5deb0febc4a5",
      "name": "Error Notification",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        240,
        820
      ],
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=={{$json.text}}",
        "messages": {
          "messageValues": [
            {
              "message": "=ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„æ—¥ç¨‹ç®¡ç†åŠ©æ‰‹ã€‚è«‹åˆ†æç”¨æˆ¶çš„ Slack è¨Šæ¯ï¼Œæå–å¯èƒ½çš„æ—¥ç¨‹ä¿¡æ¯ã€‚\n\nğŸ” åœ°é»åµæ¸¬è¦å‰‡ï¼ˆé‡è¦ï¼‰ï¼š\n1. ç§»å‹•å‹•è©å¾Œçš„åœ°é»ï¼š\n   - ã€Œå»XXã€ã€ã€Œåˆ°XXã€ã€ã€Œå¾€XXã€ã€ã€Œèµ´XXã€\n   - ã€Œå‰å¾€XXã€ã€ã€Œå‡ºç™¼åˆ°XXã€ã€ã€Œé£›å¾€XXã€\n   - ç¯„ä¾‹ï¼šã€Œå»åå¤å±‹ç©ã€â†’ location: \"åå¤å±‹\"\n\n2. ä½ç½®ä»‹è©å¾Œçš„åœ°é»ï¼š\n   - ã€Œåœ¨XXã€ã€ã€Œæ–¼XXã€ã€ã€Œä½æ–¼XXã€\n   - ã€ŒXXèˆ‰è¡Œã€ã€ã€ŒXXé€²è¡Œã€ã€ã€ŒXXå¬é–‹ã€\n   - ç¯„ä¾‹ï¼šã€Œåœ¨å°åŒ—é–‹æœƒã€â†’ location: \"å°åŒ—\"\n\n3. å¸¸è¦‹åœ°é»é¡å‹ï¼š\n   - åŸå¸‚/åœ‹å®¶ï¼šå°åŒ—ã€æ±äº¬ã€åå¤å±‹ã€æ–°åŠ å¡ã€ç¾åœ‹ã€æ—¥æœ¬\n   - åœ°æ¨™/æ™¯é»ï¼š101å¤§æ¨“ã€è¿ªå£«å°¼ã€æ•…å®®ã€å¯Œå£«å±±\n   - å ´æ‰€ï¼šæœƒè­°å®¤Aã€å’–å•¡å»³ã€é¤å»³ã€è¾¦å…¬å®¤ã€å®¶è£¡\n   - ç·šä¸Šï¼šZoomã€Teamsã€Google Meetã€è¦–è¨Šã€ç·šä¸Š\n   - å»ºç¯‰ï¼šXXå¤§æ¨“ã€XXä¸­å¿ƒã€XXé¤¨ã€XXå»³\n\n4. è¤‡åˆåœ°é»è¡¨é”ï¼š\n   - ã€Œå°åŒ—101ã€â†’ location: \"å°åŒ—101\"\n   - ã€Œæ–°ç«¹ç§‘å­¸åœ’å€ã€â†’ location: \"æ–°ç«¹ç§‘å­¸åœ’å€\"\n   - ã€Œæœƒè­°å®¤Aã€â†’ location: \"æœƒè­°å®¤A\"\n   - ã€Œç·šä¸Šæœƒè­°ã€â†’ location: \"ç·šä¸Š\"\n\n5. åœ°é»æå–å„ªå…ˆé †åºï¼š\n   - å…·é«”åœ°å€ > å»ºç¯‰åç¨± > åŸå¸‚åç¨± > å€åŸŸåç¨±\n   - å¦‚æœæœ‰å¤šå€‹åœ°é»ï¼Œé¸æ“‡æœ€å…·é«”çš„é‚£å€‹\n\n6. ç‰¹æ®Šæƒ…æ³è™•ç†ï¼š\n   - ã€ŒXXç©ã€ã€ã€ŒXXæ—…éŠã€ã€ã€ŒXXå‡ºå·®ã€â†’ XX æ˜¯åœ°é»\n   - ã€Œå›XXã€ã€ã€Œè¿”å›XXã€â†’ XX æ˜¯åœ°é»\n   - ã€ŒXXè¦‹é¢ã€ã€ã€ŒXXèšé¤ã€â†’ XX å¯èƒ½æ˜¯åœ°é»\n\nå…¨å¤©æ´»å‹•è­˜åˆ¥è¦å‰‡ï¼š\n1. æ—…éŠæ´»å‹•ï¼šã€Œå»XXç©ã€ã€ã€ŒXXæ—…éŠã€ã€ã€Œåˆ°XXã€ã€ã€ŒXXå‡ºå·®ã€\n2. å‡æœŸ/ä¼‘å‡ï¼šã€Œè«‹å‡ã€ã€ã€Œä¼‘å‡ã€ã€ã€Œæ”¾å‡ã€\n3. ç¯€æ—¥/æ…¶å…¸ï¼šã€Œç”Ÿæ—¥ã€ã€ã€Œç¯€æ—¥ã€ã€ã€Œæ´»å‹•æ—¥ã€\n4. ç ”ç¿’/èª²ç¨‹ï¼šã€Œç ”ç¿’ç‡Ÿã€ã€ã€Œå·¥ä½œåŠã€ã€ã€Œè¨“ç·´ç‡Ÿã€\n5. åªæåˆ°æ—¥æœŸæ²’æœ‰å…·é«”æ™‚é–“çš„æ´»å‹•\n\néƒ¨åˆ†æ™‚é–“æ´»å‹•è­˜åˆ¥è¦å‰‡ï¼š\n1. æœƒè­°ï¼šã€Œé–‹æœƒã€ã€ã€Œæœƒè­°ã€ã€ã€Œè¨è«–ã€\n2. ç°¡å ±ï¼šã€Œç°¡å ±ã€ã€ã€Œpresentationã€ã€ã€Œå ±å‘Šã€\n3. æœ‰æ˜ç¢ºæ™‚é–“çš„æ´»å‹•ï¼šã€Œä¸‹åˆ2é»ã€ã€ã€Œæ—©ä¸Šã€ã€ã€Œæ™šä¸Šã€\n\næ™‚é–“æ ¼å¼è¦å‰‡ï¼š\n- å…¨å¤©æ´»å‹•ï¼šstartDateTime è¨­ç‚º \"YYYY-MM-DD\"ï¼ˆä¸åŒ…å«æ™‚é–“éƒ¨åˆ†ï¼‰\n- éƒ¨åˆ†æ™‚é–“æ´»å‹•ï¼šä½¿ç”¨å®Œæ•´çš„ ISO 8601 æ ¼å¼ \"YYYY-MM-DDTHH:mm:ss+08:00\"\n\nåˆ†æè¦å‰‡ï¼š\n1. æ™‚é–“é—œéµå­—ï¼šæ˜å¤©ã€ä¸‹é€±ã€ä»Šå¤©ã€å…·é«”æ—¥æœŸã€å…·é«”æ™‚é–“\n2. æ´»å‹•é—œéµå­—ï¼šæœƒè­°ã€è¨è«–ã€ç°¡å ±ã€åŸ¹è¨“ã€ç ”ç¿’ã€æ´»å‹•ã€ç©ã€æ—…éŠ  \n3. åœ°é»ä¿¡æ¯ï¼šæœƒè­°å®¤ã€åœ°å€ã€ç·šä¸Šã€è¦–è¨Šã€åŸå¸‚åç¨±ã€å»ºç¯‰åç¨±\n4. åƒèˆ‡è€…ï¼š@ç”¨æˆ¶åã€è·ç¨±ã€éƒ¨é–€\n5. æ™‚é–“æ¨æ–·ï¼š\n   - ã€Œæ˜å¤©ä¸‹åˆã€â†’ æ˜å¤© 14:00-15:00ï¼ˆéƒ¨åˆ†æ™‚é–“ï¼‰\n   - ã€Œä¸‹é€±ä¸‰é–‹æœƒã€â†’ ä¸‹é€±ä¸‰ 09:00-10:00ï¼ˆéƒ¨åˆ†æ™‚é–“ï¼‰\n   - ã€Œ2é»é–‹æœƒã€â†’ 14:00-15:00ï¼ˆéƒ¨åˆ†æ™‚é–“ï¼‰\n   - ã€Œå»XXç©ã€â†’ å…¨å¤©æ´»å‹•ï¼ˆç´”æ—¥æœŸæ ¼å¼ï¼‰\n   - ã€ŒXXç ”ç¿’ç‡Ÿã€â†’ å…¨å¤©æ´»å‹•ï¼ˆç´”æ—¥æœŸæ ¼å¼ï¼‰\n   - ã€Œè«‹å‡ã€â†’ å…¨å¤©æ´»å‹•ï¼ˆç´”æ—¥æœŸæ ¼å¼ï¼‰\n\nè«‹æŒ‰ç…§ä»¥ä¸‹ JSON æ ¼å¼å›è¦†ï¼Œä¸è¦æ·»åŠ ä»»ä½•å…¶ä»–æ–‡å­—ï¼š\n{\n  \"hasEvent\": true,\n  \"events\": [\n    {\n      \"title\": \"äº‹ä»¶æ¨™é¡Œ\",\n      \"description\": \"è©³ç´°æè¿°\",\n      \"startDateTime\": \"2025-05-20\",\n      \"endDateTime\": \"2025-05-20\",\n      \"isAllDay\": true,\n      \"location\": \"å…·é«”åœ°é»åç¨±\",\n      \"attendees\": [\"email1@example.com\"],\n      \"confidence\": 0.95\n    }\n  ],\n  \"reasoning\": \"åˆ†æåŸå› ï¼ŒåŒ…å«åœ°é»è­˜åˆ¥é‚è¼¯\"\n}\n\nåœ°é»åµæ¸¬ç¯„ä¾‹ï¼š\n- ã€Œ5/20 å»åå¤å±‹ç©ã€â†’ location: \"åå¤å±‹\"ï¼ˆå¾ã€Œå»XXç©ã€æå–ï¼‰\n- ã€Œæ˜å¤©åœ¨æœƒè­°å®¤Aé–‹æœƒã€â†’ location: \"æœƒè­°å®¤A\"ï¼ˆå¾ã€Œåœ¨XXã€æå–ï¼‰\n- ã€Œä¸‹é€±åˆ°å°åŒ—å‡ºå·®ã€â†’ location: \"å°åŒ—\"ï¼ˆå¾ã€Œåˆ°XXå‡ºå·®ã€æå–ï¼‰\n- ã€Œ6/15 æ±äº¬è¿ªå£«å°¼ä¸€æ—¥éŠã€â†’ location: \"æ±äº¬è¿ªå£«å°¼\"ï¼ˆè¤‡åˆåœ°é»ï¼‰\n- ã€Œç·šä¸Šæœƒè­°è¨è«–å°ˆæ¡ˆã€â†’ location: \"ç·šä¸Š\"ï¼ˆè™›æ“¬åœ°é»ï¼‰\n- ã€Œåœ¨å®¶å·¥ä½œã€â†’ location: \"å®¶è£¡\"ï¼ˆå±…å®¶åœ°é»ï¼‰\n- ã€Œæ–°ç«¹ç§‘å­¸åœ’å€åƒè¨ªã€â†’ location: \"æ–°ç«¹ç§‘å­¸åœ’å€\"ï¼ˆåœ’å€åœ°é»ï¼‰\n\næ´»å‹•é¡å‹èˆ‡åœ°é»ç¯„ä¾‹ï¼š\n- ã€Œ5/20 å»åå¤å±‹ç©ã€â†’ å…¨å¤©æ´»å‹•ï¼ŒstartDateTime: \"2025-05-20\", endDateTime: \"2025-05-20\", isAllDay: true, location: \"åå¤å±‹\"\n- ã€Œæ˜å¤©ä¸‹åˆ2é»åœ¨æœƒè­°å®¤Bç°¡å ±ã€â†’ éƒ¨åˆ†æ™‚é–“ï¼ŒstartDateTime: \"2025-05-21T14:00:00+08:00\", endDateTime: \"2025-05-21T15:00:00+08:00\", isAllDay: false, location: \"æœƒè­°å®¤B\"\n- ã€Œ6/15 å°åŒ—101ç ”ç¿’ç‡Ÿã€â†’ å…¨å¤©æ´»å‹•ï¼ŒstartDateTime: \"2025-06-15\", endDateTime: \"2025-06-15\", isAllDay: true, location: \"å°åŒ—101\"\n- ã€Œä¸‹é€±ä¸‰ä¸Šåˆ10é»ç·šä¸Šæœƒè­°ã€â†’ éƒ¨åˆ†æ™‚é–“ï¼ŒstartDateTime: \"2025-06-04T10:00:00+08:00\", endDateTime: \"2025-06-04T11:00:00+08:00\", isAllDay: false, location: \"ç·šä¸Š\"\n\nä¿¡å¿ƒåº¦è©•ä¼°ï¼š\n- 0.9+: å®Œæ•´æ™‚é–“+åœ°é»+æ´»å‹•é¡å‹æ˜ç¢º\n- 0.7-0.9: æ˜ç¢ºæ™‚é–“å’Œæ´»å‹•ï¼Œåœ°é»å¯æ¨æ–·\n- 0.5-0.7: æ¨¡ç³Šæ™‚é–“æˆ–æ´»å‹•é¡å‹ï¼Œåœ°é»ä¸æ˜ç¢º\n- <0.5: ç¼ºä¹é—œéµä¿¡æ¯\n\né è¨­è¨­å®šï¼š\n- æ™‚å€ï¼šAsia/Taipei (+08:00)\n- éƒ¨åˆ†æ™‚é–“æ´»å‹•é è¨­æ™‚é•·ï¼š1å°æ™‚\n- ç„¡å…·é«”æ™‚é–“çš„æœƒè­°ï¼š09:00-10:00\n- æ—…éŠ/ä¼‘å‡/ç ”ç¿’ç­‰ï¼šå…¨å¤©æ´»å‹•\n- åœ°é»æå–ï¼šå„ªå…ˆæå–æœ€å…·é«”çš„åœ°é»ä¿¡æ¯\n\nç¾åœ¨è«‹åˆ†æä»¥ä¸‹ Slack è¨Šæ¯ï¼šã€Œ={{$json.text}}ã€\n\nâš ï¸ é‡è¦ï¼šè«‹ç‰¹åˆ¥æ³¨æ„åœ°é»ä¿¡æ¯çš„æå–ï¼Œç¢ºä¿ä¸éºæ¼ä»»ä½•åœ°é»ç›¸é—œçš„è©èªã€‚\n\nè«‹æŒ‰ç…§ä»¥ä¸‹ JSON æ ¼å¼å›è¦†ï¼Œä¸è¦æ·»åŠ ä»»ä½•å…¶ä»–æ–‡å­—ï¼š\n{\n  \"hasEvent\": true,\n  \"events\": [\n    {\n      \"title\": \"äº‹ä»¶æ¨™é¡Œ\",\n      \"description\": \"è©³ç´°æè¿°\",\n      \"startDateTime\": \"2025-05-20\",\n      \"endDateTime\": \"2025-05-20\",\n      \"isAllDay\": true,\n      \"location\": \"åœ°é»ï¼ˆå¦‚æœæœ‰ï¼‰\",\n      \"attendees\": [\"email1@example.com\"],\n      \"confidence\": 0.95\n    }\n  ],\n  \"reasoning\": \"åˆ†æåŸå› \"\n}\n\nç¯„ä¾‹ï¼š\n- ã€Œ5/20 å»åå¤å±‹ç©ã€â†’ å…¨å¤©æ´»å‹•ï¼ŒstartDateTime: \"2025-05-20\", endDateTime: \"2025-05-20\", isAllDay: true\n- ã€Œæ˜å¤©ä¸‹åˆ2é»é–‹æœƒã€â†’ éƒ¨åˆ†æ™‚é–“ï¼ŒstartDateTime: \"2025-05-21T14:00:00+08:00\", endDateTime: \"2025-05-21T15:00:00+08:00\", isAllDay: false\n- ã€Œ6/15 ç ”ç¿’ç‡Ÿã€â†’ å…¨å¤©æ´»å‹•ï¼ŒstartDateTime: \"2025-06-15\", endDateTime: \"2025-06-15\", isAllDay: true\n\nä¿¡å¿ƒåº¦è©•ä¼°ï¼š\n- 0.9+: å®Œæ•´æ™‚é–“+åœ°é»+æ´»å‹•é¡å‹æ˜ç¢º\n- 0.7-0.9: æ˜ç¢ºæ™‚é–“å’Œæ´»å‹•ï¼Œéƒ¨åˆ†ä¿¡æ¯å¯æ¨æ–·\n- 0.5-0.7: æ¨¡ç³Šæ™‚é–“æˆ–æ´»å‹•é¡å‹\n- <0.5: ç¼ºä¹é—œéµä¿¡æ¯\n\né è¨­è¨­å®šï¼š\n- æ™‚å€ï¼šAsia/Taipei (+08:00)\n- éƒ¨åˆ†æ™‚é–“æ´»å‹•é è¨­æ™‚é•·ï¼š1å°æ™‚\n- ç„¡å…·é«”æ™‚é–“çš„æœƒè­°ï¼š09:00-10:00\n- æ—…éŠ/ä¼‘å‡/ç ”ç¿’ç­‰ï¼šå…¨å¤©æ´»å‹•\n\nç¾åœ¨è«‹åˆ†æä»¥ä¸‹ Slack è¨Šæ¯ï¼šã€Œ={{$json.text}}ã€\n\nè«‹ä»”ç´°åˆ†æä¸¦æå–æ—¥ç¨‹ä¿¡æ¯ï¼Œç›´æ¥å›è¦† JSON æ ¼å¼ï¼Œä¸è¦åŒ…å« ```json æ¨™è¨˜ã€‚"
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.6,
      "position": [
        680,
        460
      ],
      "id": "8647c7c5-4e06-482e-8fd8-df39c3077d31",
      "name": "Basic LLM Chain"
    },
    {
      "parameters": {
        "model": "o4-mini",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "typeVersion": 1,
      "position": [
        768,
        680
      ],
      "id": "2dafdd15-fc8c-468f-ab93-caf25ce29c9f",
      "name": "Azure OpenAI Chat Model",
      "credentials": {
        "azureOpenAiApi": {
          "id": "CtgkMRzzV4whz91f",
          "name": "Azure Open AI account"
        }
      }
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "abc12207@gmail.com",
          "mode": "list",
          "cachedResultName": "abc12207@gmail.com"
        },
        "start": "={{$json.startDateTime}}",
        "end": "={{$json.endDateTime}}",
        "additionalFields": {
          "allday": "no",
          "description": "={{$json.description}}",
          "location": "={{$json.location}}",
          "maxAttendees": 50,
          "sendUpdates": "all",
          "summary": "={{$json.title}}"
        }
      },
      "id": "0f6d6c00-f47a-400f-b443-3b7c0ac88fc8",
      "name": "Create Calendar Event3",
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1,
      "position": [
        1716,
        460
      ],
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "ERUGcDCTMJESC4hA",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "fbf960d0-2def-463d-9c6b-e9fa9d63368a",
              "leftValue": "={{ $json.isAllDay }}",
              "rightValue": "true",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1496,
        360
      ],
      "id": "1c707ca2-6571-4347-a56b-3e79f85d99bc",
      "name": "All Day Event branch"
    }
  ],
  "pinData": {},
  "connections": {
    "Slack Trigger": {
      "main": [
        [
          {
            "node": "Filter Channel Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Channel Messages": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process AI Response": {
      "main": [
        [
          {
            "node": "Confidence Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Confidence Filter": {
      "main": [
        [
          {
            "node": "All Day Event branch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Low Confidence Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Calendar Event": {
      "main": [
        [
          {
            "node": "Success Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Azure OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "Process AI Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Calendar Event3": {
      "main": [
        [
          {
            "node": "Success Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "All Day Event branch": {
      "main": [
        [
          {
            "node": "Create Calendar Event",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create Calendar Event3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "saveExecutionProgress": true,
    "saveManualExecutions": true,
    "saveDataErrorExecution": "all",
    "saveDataSuccessExecution": "all",
    "executionTimeout": 3600,
    "timezone": "UTC"
  },
  "versionId": "2d6292d7-f81a-4938-a85b-08a066504c11",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4f325a7cd315a1a79ed49dc0c3f91bbcfea6ece3018280e4ffc9f22ce531b657"
  },
  "id": "I2dch7ZKvBvX6GVC",
  "tags": []
}