{
  "name": "Daily Currency Exchange Rate Alert",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 1,10 * * 1-5"
            }
          ]
        }
      },
      "id": "6917af19-058b-4fc0-a0df-9e47ddc08bc0",
      "name": "å®šæ™‚è§¸ç™¼å™¨",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        400,
        -160
      ]
    },
    {
      "parameters": {
        "url": "=https://v6.exchangerate-api.com/v6/{{$env.EXCHANGE_API_KEY}}/latest/TWD",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "8e1c3e0e-8ac2-4ff2-a3e9-3fb7c354e636",
      "name": "å–å¾—å³æ™‚åŒ¯ç‡",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        620,
        -160
      ]
    },
    {
      "parameters": {
        "jsCode": "// ç”Ÿæˆç°¡åŒ–ç‰ˆåŒ¯ç‡å ±å‘Š\nconst data = $input.first().json;\nconst now = new Date();\n\n// åˆ¤æ–·æ˜¯æ—©ç›¤é‚„æ˜¯æ™šç›¤ (åŸºæ–¼ UTC æ™‚é–“)\nconst utcHour = now.getUTCHours();\nconst isEveningReport = utcHour >= 10; // UTC 10é» = å°åŒ—18é»\nconst timeLabel = isEveningReport ? 'æ™šç›¤ 18:00' : 'æ—©ç›¤ 9:00';\n\nconsole.log(`ç”Ÿæˆ${timeLabel}å ±å‘Š`);\nconsole.log('ç•¶å‰ UTC æ™‚é–“:', utcHour + ':' + now.getUTCMinutes());\n\nconst rates = data.conversion_rates;\nif (!rates) {\n  throw new Error('æ‰¾ä¸åˆ°åŒ¯ç‡è³‡æ–™');\n}\n\n// ç›®æ¨™è²¨å¹£åŒ¯ç‡è¨ˆç®—ï¼ˆæ—¥åœ“æ”¹ç‚º1æ—¥åœ“å–®ä½ï¼‰\nconst currencies = {\n  'USD': { name: 'ç¾å…ƒ', flag: 'ğŸ‡ºğŸ‡¸', rate: (1/rates.USD).toFixed(2), unit: '1 ç¾å…ƒ' },\n  'JPY': { name: 'æ—¥åœ“', flag: 'ğŸ‡¯ğŸ‡µ', rate: (1/rates.JPY).toFixed(4), unit: '1 æ—¥åœ“' },\n  'AUD': { name: 'æ¾³å¹£', flag: 'ğŸ‡¦ğŸ‡º', rate: (1/rates.AUD).toFixed(2), unit: '1 æ¾³å¹£' },\n  'CAD': { name: 'åŠ å¹£', flag: 'ğŸ‡¨ğŸ‡¦', rate: (1/rates.CAD).toFixed(2), unit: '1 åŠ å¹£' }\n};\n\n// ç”Ÿæˆè¨Šæ¯ï¼ˆæ•¸å­—æ›´å¤§æ›´é†’ç›®ï¼‰\nconst message = `ğŸ’± å°å¹£åŒ¯ç‡å ±å‘Š â”‚ ${timeLabel}\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“Š *å³æ™‚åŒ¯ç‡ (TWD åŸºæº–)*\n\n${Object.entries(currencies).map(([code, info]) => {\n  return `${info.flag} *${code}*\\t\\t*\\`${info.rate}\\`* å…ƒ`;\n}).join('\\n')}\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ’¡ *åŒ¯ç‡èªªæ˜ï¼š*\n- ${currencies.USD.unit} = *\\`${currencies.USD.rate}\\`* å°å¹£\n- ${currencies.JPY.unit} = *\\`${currencies.JPY.rate}\\`* å°å¹£  \n- ${currencies.AUD.unit} = *\\`${currencies.AUD.rate}\\`* å°å¹£\n- ${currencies.CAD.unit} = *\\`${currencies.CAD.rate}\\`* å°å¹£\n\nğŸ•˜ *ä¸‹æ¬¡æ›´æ–°ï¼š* ${isEveningReport ? 'æ˜æ—¥æ—©ç›¤ 9:00' : 'æ™šç›¤ 18:00'}\n\nğŸ“ è³‡æ–™ä¾†æºï¼šExchangeRate-API\nğŸ¤– ç”±ç³»çµ±è‡ªå‹•æ›´æ–°`;\n\nconst taiwanTime = new Date(now.getTime() + 8 * 60 * 60 * 1000);\nconsole.log('å°åŒ—æ™‚é–“:', taiwanTime.toLocaleString('zh-TW'));\nconsole.log('è¨Šæ¯é•·åº¦:', message.length);\n\nreturn {\n  json: {\n    message: message,\n    timeLabel: timeLabel,\n    updateTime: taiwanTime.toISOString(),\n    currencies: currencies\n  }\n};"
      },
      "id": "ec99d152-d3e7-4840-9b14-ec0cbeaddb92",
      "name": "ç”Ÿæˆç°¡åŒ–å ±å‘Š",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        840,
        -160
      ]
    },
    {
      "parameters": {
        "channel": "#n8n-currency",
        "text": "={{$json.message}}",
        "otherOptions": {},
        "attachments": []
      },
      "id": "fc101e68-a029-4421-835a-f760087e5f6a",
      "name": "ç™¼é€åˆ° Slack",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        1060,
        -160
      ],
      "credentials": {
        "slackApi": {
          "id": "H8RWtu7aOphSXGk5",
          "name": "Slack account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "å®šæ™‚è§¸ç™¼å™¨": {
      "main": [
        [
          {
            "node": "å–å¾—å³æ™‚åŒ¯ç‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å–å¾—å³æ™‚åŒ¯ç‡": {
      "main": [
        [
          {
            "node": "ç”Ÿæˆç°¡åŒ–å ±å‘Š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”Ÿæˆç°¡åŒ–å ±å‘Š": {
      "main": [
        [
          {
            "node": "ç™¼é€åˆ° Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "75bbb8b7-18ce-4cf5-9847-b3b2d77e8525",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4f325a7cd315a1a79ed49dc0c3f91bbcfea6ece3018280e4ffc9f22ce531b657"
  },
  "id": "6dxyoDlrqpZYcYnY",
  "tags": [
    {
      "createdAt": "2025-06-22T02:38:50.887Z",
      "updatedAt": "2025-06-22T02:38:50.887Z",
      "id": "zqsdwQAC8uguoId9",
      "name": "åŒ¯ç‡"
    },
    {
      "createdAt": "2025-06-22T02:38:50.890Z",
      "updatedAt": "2025-06-22T02:38:50.890Z",
      "id": "d6lkB0bGQ583pWQt",
      "name": "å°å¹£"
    }
  ]
}